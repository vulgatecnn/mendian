# 消息中心模块

## 功能概述

消息中心模块提供系统消息的统一管理和展示功能，支持消息的查看、标记、删除等操作。

## 主要功能

### 1. 消息列表展示
- 分页加载消息列表
- 支持按消息类型分类展示
- 显示消息状态（已读/未读）
- 消息内容预览

### 2. 未读消息提醒
- 实时显示未读消息数量
- 红点提醒未读消息
- 自动轮询更新未读数量（30秒间隔）

### 3. 消息已读标记
- 单个消息标记已读
- 批量标记已读
- 全部标记已读
- 点击消息自动标记已读

### 4. 消息跳转功能
- 点击消息跳转到相关业务页面
- 支持审批、提醒等业务场景跳转

### 5. 消息搜索和筛选
- 按消息类型筛选（审批通知、提醒通知、系统通知、业务通知）
- 按阅读状态筛选（已读/未读）
- 按时间范围筛选
- 关键词搜索（标题和内容）

### 6. 消息删除功能
- 单个消息删除
- 批量删除消息
- 删除前确认提示

### 7. 实时消息推送
- 采用轮询方式实现实时更新
- 每30秒自动检查新消息
- 未读数量实时更新

## 页面组件

### MessageCenter
主要的消息中心页面组件，包含所有消息管理功能。

**Props**: 无

**主要功能**:
- 消息列表展示和分页
- 消息筛选和搜索
- 消息已读标记
- 消息删除
- 消息跳转

## API 集成

### 使用的 API 接口

```typescript
// 获取消息列表
GET /api/messages/
参数: page, page_size, type, is_read, start_date, end_date

// 获取未读消息数量
GET /api/messages/unread-count/

// 标记消息为已读
POST /api/messages/{id}/mark-read/

// 批量标记消息为已读
POST /api/messages/mark-read-batch/
Body: { ids: number[] }

// 标记全部消息为已读
POST /api/messages/mark-all-read/

// 删除消息
DELETE /api/messages/{id}/

// 批量删除消息
POST /api/messages/delete-batch/
Body: { ids: number[] }
```

## 消息类型

系统支持以下消息类型：

- **approval**: 审批通知（蓝色标签）
- **reminder**: 提醒通知（橙色标签）
- **system**: 系统通知（绿色标签）
- **notification**: 业务通知（紫色标签）

## 使用示例

```typescript
import { MessageCenter } from '../pages/message'

// 在路由中使用
<Route path="/messages" element={<MessageCenter />} />
```

## 样式定制

消息中心使用 CSS Modules 进行样式管理，主要样式类：

- `.container`: 页面容器
- `.header`: 页面头部
- `.filterBar`: 筛选条件区域
- `.batchActions`: 批量操作区域
- `.messageTitle`: 消息标题样式

## 响应式设计

- 支持移动端适配
- 筛选条件自动换行
- 表格支持横向滚动

## 性能优化

1. **分页加载**: 避免一次性加载大量消息
2. **轮询优化**: 使用30秒间隔，避免频繁请求
3. **批量操作**: 支持批量标记和删除，减少请求次数
4. **懒加载**: 表格数据按需加载

## 注意事项

1. 消息跳转功能依赖消息的 `link` 字段
2. 实时推送采用轮询方式，可根据需要改为 WebSocket
3. 批量操作前会进行确认提示
4. 删除操作不可恢复，需谨慎操作

## 未来改进

1. 支持 WebSocket 实时推送
2. 支持消息分组展示
3. 支持消息优先级排序
4. 支持消息导出功能
5. 支持消息模板配置
