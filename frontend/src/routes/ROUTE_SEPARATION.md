# PC端和移动端路由分离说明

## 概述

本系统实现了完全分离的PC端和移动端路由配置，确保两个平台的路由不会冲突，并提供智能的平台检测和重定向功能。

## 路由架构

```
src/routes/
├── index.tsx          # 主路由配置 - 智能平台分发
├── pc.tsx            # PC端路由配置
├── mobile.tsx        # 移动端路由配置
└── mobile.css        # 移动端路由样式
```

## 平台检测逻辑

系统通过以下优先级检测用户平台：

1. **URL路径检测**：如果路径以 `/mobile` 开头，则为移动端
2. **企业微信环境**：检测 User-Agent 中的 `wxwork` 标识
3. **移动设备检测**：屏幕宽度 ≤ 768px 且 User-Agent 包含移动设备标识

## 路由分离策略

### PC端路由 (`/routes/pc.tsx`)

- **路径前缀**：无前缀（根路径）
- **主要路由**：
  - `/` - PC端首页
  - `/login` - PC端登录页
  - `/profile` - PC端个人中心
  - `/messages` - PC端消息中心
  - `/system/*` - 系统管理模块
  - `/store-*/*` - 各业务模块
  - `/approval/*` - 审批中心
  - `/base-data/*` - 基础数据管理

### 移动端路由 (`/routes/mobile.tsx`)

- **路径前缀**：`/mobile`
- **主要路由**：
  - `/mobile/home` - 移动端首页
  - `/mobile/login` - 移动端登录页（企业微信）
  - `/mobile/work` - 移动端工作台
  - `/mobile/expansion/*` - 拓店管理
  - `/mobile/preparation/*` - 开店筹备
  - `/mobile/approvals/*` - 审批中心
  - `/mobile/messages` - 消息中心
  - `/mobile/profile` - 个人中心

## 智能重定向机制

### 自动平台重定向

1. **移动端访问PC端路由**：自动重定向到对应的移动端路由
2. **PC端访问移动端路由**：保持原路由（支持PC端访问移动端页面）
3. **根路径访问**：根据平台检测结果重定向到对应首页

### 重定向规则

```typescript
// 移动端环境下的重定向规则
const redirectRules = {
  '/': '/mobile/home',
  '/login': '/mobile/login',
  '/profile': '/mobile/profile',
  '/messages': '/mobile/messages',
  // 其他路由重定向到移动端首页
  '*': '/mobile/home'
}
```

## 布局分离

### PC端布局

- 使用 Arco Design 的 Layout 组件
- 包含顶部导航、侧边栏、内容区域
- 适配大屏幕显示

### 移动端布局

- 使用独立的 MobileLayout 组件
- 底部导航栏设计
- 适配移动端触摸操作

## 样式分离

### PC端样式

- 使用 `App.css` 和各模块的 `.module.css` 文件
- 适配桌面端交互

### 移动端样式

- 使用 `mobile.css` 和移动端专用样式文件
- 响应式设计，适配不同移动设备尺寸
- 触摸友好的交互设计

## 组件分离

### PC端组件

- 位于 `src/pages/` 各模块目录下
- 使用 Arco Design 组件库
- 适配鼠标和键盘操作

### 移动端组件

- 位于 `src/pages/mobile/` 目录下
- 专门为移动端优化的组件
- 支持触摸手势和移动端特性

## 开发指南

### 添加新的PC端路由

1. 在 `src/routes/pc.tsx` 中添加路由配置
2. 创建对应的页面组件
3. 添加权限控制（如需要）

### 添加新的移动端路由

1. 在 `src/routes/mobile.tsx` 中添加路由配置
2. 在 `src/pages/mobile/` 下创建对应组件
3. 确保路径以 `/mobile` 开头

### 测试路由分离

1. **PC端测试**：在桌面浏览器中访问各路由
2. **移动端测试**：
   - 使用移动设备或开发者工具的移动模式
   - 在企业微信中测试
   - 验证自动重定向功能

## 注意事项

1. **路由冲突**：确保PC端和移动端路由不会冲突
2. **权限控制**：两个平台的权限控制保持一致
3. **数据共享**：使用相同的API和数据服务
4. **状态管理**：认证状态和权限状态在两个平台间共享
5. **SEO优化**：PC端路由考虑SEO友好的URL设计

## 未来扩展

1. **平板适配**：可以添加平板专用的路由和布局
2. **PWA支持**：移动端可以扩展为PWA应用
3. **深度链接**：支持移动端的深度链接功能
4. **离线模式**：移动端可以添加离线访问支持